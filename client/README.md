# Nexora - Клиентская часть

Веб-приложение для мониторинга системы в реальном времени. Позволяет отслеживать процессы, метрики CPU и памяти, сетевые соединения, управлять портами и записывать историю метрик.

## Технологии

- **Vue 3** - фреймворк для построения интерфейса
- **TypeScript** - типизация кода
- **Pinia** - управление состоянием (Flux-подобный паттерн)
- **Vue Router** - маршрутизация
- **Vite** - сборщик и dev-сервер
- **Axios** - HTTP-клиент для запросов к API
- **Chart.js** - графики для визуализации метрик
- **WebSocket** - подключение для получения данных в реальном времени

## Функционал

### Информация о системе

Страница с детальной информацией об устройстве:

- **Операционная система**: хост, платформа, версия ядра, uptime, load average
- **Память**: общий объем, использовано, доступно, swap
- **Диски и разделы**: информация о всех подключенных дисках с данными об использовании
- **SMART / Health**: статус здоровья дисков, температура, время работы, износ NVMe, предупреждения
- **Процессор**: название, производитель, архитектура, физические и логические ядра, частота, кэш
- **Поддерживаемые инструкции**: список всех поддерживаемых инструкций процессора с описаниями (SSE, AVX, AES-NI и т.д.)

### Системные метрики

Страница с графиками метрик в реальном времени:

- **CPU**: график загрузки процессора с последними 60 точками данных
- **Память**: график использования памяти в процентах
- **Экспорт данных**: возможность выгрузить сохраненные метрики из базы данных в JSON

Метрики обновляются через WebSocket подключение. При отключении мониторинга графики показывают последние известные значения.

### Процессы

Управление запущенными процессами:

- **Список процессов**: таблица со всеми процессами системы
- **Поиск**: по PID, имени процесса, порту
- **Фильтры**: по пользователю, диапазону CPU (%), диапазону памяти (МБ)
- **Сортировка**: по CPU или памяти (возрастание/убывание)
- **Визуализация**: цветовая индикация нагрузки (нормальная/повышенная/критическая)
- **Детали процесса**: модальное окно с полной информацией о процессе
- **Завершение процесса**: возможность завершить процесс с подтверждением
- **Экспорт**: выгрузка списка процессов в JSON или CSV
- **Скрытие неизвестных**: фильтр для скрытия процессов без полной информации (требуются права администратора)

Процессы обновляются каждые 5 секунд через WebSocket. Активные процессы отображаются первыми, затем неактивные.

### Менеджер портов

Управление сетевыми соединениями и запуск процессов:

- **Сетевые соединения**: таблица всех активных соединений (TCP/UDP)
  - Локальный и удаленный адреса
  - Протокол и статус (LISTEN, ESTABLISHED и т.д.)
  - PID и имя процесса
  - Фильтрация по статусу и поиск по PID/процессу/порту/адресу
  - Завершение процессов, использующих порты
- **Сетевые интерфейсы**: статистика по каждому интерфейсу
  - Принято/отправлено данных (MB)
  - Ошибки и потерянные пакеты
  - Автообновление каждые 5 секунд
- **Топ процессов**: список процессов по количеству сетевых соединений
- **Запуск процессов**: модальное окно для запуска новых процессов
  - Пресеты для быстрого запуска (Vite, npm, node, Python HTTP)
  - История недавних запусков (сохраняется в localStorage)
  - Проверка занятости портов перед запуском
  - Предложение свободного порта, если желаемый занят
  - Поддержка аргументов командной строки и рабочей директории

### История метрик

Просмотр сохраненных метрик из базы данных:

- **Фильтрация**: по дате начала и окончания, лимит записей
- **Таблица метрик**: время, CPU %, память %, использовано/всего памяти (МБ)
- **Экспорт**: выгрузка данных в JSON
- **Очистка**: удаление всех метрик из базы данных

### Запись метрик

Функция автоматической записи метрик при превышении порогов:

- **FAB кнопка**: плавающая кнопка в правом нижнем углу
- **Настройки записи**:
  - Порог CPU (%)
  - Порог памяти (%)
  - Длительность записи (минуты, минимум 1)
- **Автоматический запуск**: запись начинается автоматически при превышении порогов
- **Уведомления**: оповещения о начале и окончании записи
- **Статус**: отображение оставшегося времени записи

Записанные метрики сохраняются в базу данных и доступны на странице истории метрик.

## Архитектура

Приложение построено на паттерне Flux с использованием Pinia для управления состоянием.

### Паттерн Flux

Flux - это архитектурный паттерн для одностороннего потока данных:

1. **Actions** (Действия) - вызываются из компонентов для изменения состояния
2. **Stores** (Хранилища) - содержат состояние и логику его изменения
3. **Views** (Представления) - компоненты Vue, которые отображают данные из stores
4. **Services** (Сервисы) - слой для взаимодействия с API и внешними ресурсами

В этом проекте:

- **Stores** (`src/stores/`) - Pinia stores, содержат состояние и actions
- **Services** (`src/services/`) - классы для работы с API, WebSocket, бизнес-логика
- **Components** (`src/components/`) - Vue компоненты (Views)
- **Pages** (`src/pages/`) - страницы приложения

### Dependency Injection

Используется DI-контейнер для управления зависимостями:

- Все сервисы создаются в `src/di/services.ts`
- Сервисы доступны через Pinia plugin `piniaServices`
- В компонентах доступны через `this.$services` или `useServices()` composable

### Структура данных

- **Stores** - реактивное состояние, actions для изменения
- **Services** - методы для работы с API, WebSocket клиенты
- **Types** - TypeScript типы для всех данных
- **Components** - переиспользуемые UI компоненты
- **Pages** - страницы приложения с роутингом

### WebSocket подключения

Для получения данных в реальном времени используются два WebSocket клиента:

- **MetricsRealtimeClient** - метрики CPU и памяти
- **ProcessesRealtimeClient** - список процессов

Оба клиента автоматически переподключаются при разрыве соединения.

## Запуск проекта

### Требования

- Node.js 18+ 
- npm или yarn

### Установка зависимостей

```bash
npm install
```

### Настройка

Создайте файл `.env` в корне проекта (опционально):

```env
VITE_BACKEND_URL=http://localhost:8080
```

По умолчанию используется `http://localhost:8080`.

### Разработка

Запуск dev-сервера:

```bash
npm run dev
```

Приложение будет доступно по адресу `http://localhost:5173` (или другой порт, если 5173 занят).

### Сборка

Сборка для production:

```bash
npm run build
```

Собранные файлы будут в папке `dist/`.

### Просмотр сборки

Просмотр production сборки локально:

```bash
npm run preview
```

## Структура проекта

```
src/
├── assets/              # Статические ресурсы (изображения)
├── components/          # Vue компоненты
│   ├── app-header/      # Шапка приложения
│   ├── app-loader/      # Индикатор загрузки
│   ├── app-nav/         # Навигация
│   ├── cpu-chart/       # График CPU
│   ├── memory-chart/    # График памяти
│   ├── processes/       # Компоненты для работы с процессами
│   ├── recording-fab/   # FAB кнопка записи метрик
│   └── ...
├── composables/         # Vue composables
├── config/             # Конфигурация (backend URL, версия)
├── di/                 # Dependency Injection
│   ├── keys.ts         # Ключи для DI
│   └── services.ts     # Фабрика сервисов
├── pages/              # Страницы приложения
│   ├── DeviceInfoPage.vue
│   ├── MetricsPage.vue
│   ├── ProcessesPage.vue
│   ├── PortManagerPage.vue
│   └── MetricsHistoryPage.vue
├── plugins/            # Vue плагины
├── router/             # Конфигурация роутера
├── services/           # Сервисы для работы с API
│   ├── http/           # HTTP клиент
│   ├── realtime/       # WebSocket клиенты
│   ├── monitoring/     # Мониторинг
│   ├── processes/      # Процессы
│   ├── ports/          # Порты
│   ├── recording/      # Запись метрик
│   └── ...
├── stores/             # Pinia stores
│   ├── metrics.ts      # Состояние метрик
│   ├── processes.ts    # Состояние процессов
│   ├── recording.ts    # Состояние записи
│   └── ...
├── types/              # TypeScript типы
├── App.vue             # Корневой компонент
├── main.ts             # Точка входа
└── style.css           # Глобальные стили
```

## Основные страницы

- `/` - Информация о системе
- `/metrics` - Системные метрики (CPU, память)
- `/processes` - Управление процессами
- `/port-manager` - Менеджер портов и сетевых соединений
- `/metrics-history` - История сохраненных метрик

## Особенности реализации

- **Автоматическое переподключение WebSocket** при разрыве соединения
- **Оптимизация рендеринга** - виртуализация таблиц процессов с пагинацией
- **Цветовая индикация** нагрузки процессов и метрик
- **Локальное хранение** истории запусков процессов в менеджере портов
- **Уведомления** о важных событиях (запись метрик, ошибки)
- **Адаптивный дизайн** для работы на разных размерах экрана

## Зависимости от бэкенда

Приложение требует работающий бэкенд-сервер, который предоставляет:

- REST API для получения информации о системе, процессах, портах
- WebSocket endpoints для метрик и процессов
- API для управления мониторингом (включение/выключение)
- API для записи метрик и работы с историей
- API для запуска и завершения процессов

Все запросы идут на адрес, указанный в `VITE_BACKEND_URL` (по умолчанию `http://localhost:8080`).

